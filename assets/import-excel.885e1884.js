import{P as e}from"./PageWrapper.fa80137e.js";import{d as t,b as a,c as r,K as s,i as o,B as i,a as l,aI as n,j as d,bS as c}from"./index.48f34480.js";import{u as p}from"./useExcel.e89b4c87.js";import{C as m}from"./Card.9cbad327.js";import{A as u}from"./index.0e1ccd8c.js";import{U as x}from"./index.736ec670.js";import{C as f}from"./CloudUploadOutlined.7f266ba6.js";import{A as j}from"./index.24cba53a.js";import"./Col.0443a4c4.js";import"./useFlexGapSupport.0ed8aa8a.js";import"./EyeOutlined.4a4ed7ff.js";import"./DeleteOutlined.10962e4f.js";import"./CheckOutlined.bb45c035.js";import"./index.319a1eed.js";import"./Form.b8b477e2.js";import"./toArray.215d9ccb.js";import"./FormItemContext.1c14973d.js";import"./iconUtil.22d5268e.js";import"./List.587632d1.js";import"./index.ed4cd23f.js";import"./antInputDirective.8e6978aa.js";import"./SearchOutlined.4005fe30.js";import"./index.17e1e0c0.js";import"./Checkbox.a2286f2d.js";import"./Checkbox.f42f0af6.js";import"./index.a5a338d2.js";import"./Group.89ee4d61.js";import"./index.603a33d1.js";import"./Input.2ce3cae6.js";import"./index.fa237d7c.js";const b=t({name:"ImportExcel",setup(){const t=a([]),b=a([]),{readDataFromExcel:C}=p();function g(){n(c)}function h(e){const{file:a}=e,r=a.originFileObj;if(!r)return;if(!/\.(xlsx|xls|csv)$/.test(r.name))return void d.warning("Excel文件只支持.xlsx, .xls, .csv格式!");r.size/1024/1024<1?function(e){const a=new FileReader;a.onload=e=>{const a=e.target&&e.target.result,{header:r,results:s}=C(a,"array");b.value=r.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=s},a.readAsArrayBuffer(e),a.onerror=()=>{d.error("Excel文件读取出错!")}}(r):d.warning("上传的Excel文件大小不能超过1M!")}return()=>r(e,{name:"JS-xlsx插件"},{header:()=>r(s,null,[r("p",null,[o("JS-xlsx: 由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库, 功能强大, 支持xlsx、csv、txt等格式。")]),r("p",null,[o("组件地址:"),r(i,{type:"link",onClick:g},{default:()=>[o("立即访问")]})])]),default:()=>r(m,{bordered:!1},{default:()=>[r(u,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[r(x,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:h},{default:()=>[r("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[r(f,null,null)]),r("p",null,[o("将Excel文件拖到此处, 或"),r("span",{style:"color: #1890ff;"},[o("点击上传")])])]}),r(j,{dataSource:l(t),columns:l(b),pagination:!1},null)]})]})})}});export{b as default};

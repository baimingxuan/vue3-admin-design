import{q as e,c as t,bu as n,J as o,z as i,aw as r,y as l,d as a,r as s,bs as u,bi as c,b as v,P as f,s as h,at as d,a1 as p,a4 as g,l as m,Y as b,a6 as M,I as y,a5 as S,aT as E,Z as H,N as T}from"./index.48f34480.js";function R(){return function e(t){e.current=t}}var w=function(r,l){var a,s=r.height,u=r.offset,c=r.prefixCls,v=r.onInnerResize,f=l.slots,h={},d={display:"flex",flexDirection:"column"};return void 0!==u&&(h={height:"".concat(s,"px"),position:"relative",overflow:"hidden"},d=e(e({},d),{transform:"translateY(".concat(u,"px)"),position:"absolute",left:0,right:0,top:0})),t("div",{style:h},[t(n,{onResize:function(e){e.offsetHeight&&v&&v()}},{default:function(){return[t("div",{style:d,class:o(i({},"".concat(c,"-holder-inner"),c))},[null===(a=f.default)||void 0===a?void 0:a.call(f)])]}})])};w.displayName="Filter",w.inheritAttrs=!1,w.props={prefixCls:String,height:Number,offset:Number,onInnerResize:Function};const x=w;var L=function(e,t){var n,o=e.setRef,i=t.slots,a=r(null===(n=i.default)||void 0===n?void 0:n.call(i));return a&&a.length?l(a[0],{ref:o}):a};L.props={setRef:{type:Function,default:function(){}}};const D=L;function C(e){return"touches"in e?e.touches[0].pageY:e.pageY}const F=a({name:"ScrollBar",inheritAttrs:!1,props:{prefixCls:String,scrollTop:Number,scrollHeight:Number,height:Number,count:Number,onScroll:{type:Function},onStartMove:{type:Function},onStopMove:{type:Function}},setup:function(){return{moveRaf:null,scrollbarRef:function e(t){e.current=t},thumbRef:function e(t){e.current=t},visibleTimeout:null,state:s({dragging:!1,pageY:null,startTop:null,visible:!1})}},watch:{scrollTop:{handler:function(){this.delayHidden()},flush:"post"}},mounted:function(){var e,t;null===(e=this.scrollbarRef.current)||void 0===e||e.addEventListener("touchstart",this.onScrollbarTouchStart,!!u&&{passive:!1}),null===(t=this.thumbRef.current)||void 0===t||t.addEventListener("touchstart",this.onMouseDown,!!u&&{passive:!1})},beforeUnmount:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)},methods:{delayHidden:function(){var e=this;clearTimeout(this.visibleTimeout),this.state.visible=!0,this.visibleTimeout=setTimeout((function(){e.state.visible=!1}),2e3)},onScrollbarTouchStart:function(e){e.preventDefault()},onContainerMouseDown:function(e){e.stopPropagation(),e.preventDefault()},patchEvents:function(){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.thumbRef.current.addEventListener("touchmove",this.onMouseMove,!!u&&{passive:!1}),this.thumbRef.current.addEventListener("touchend",this.onMouseUp)},removeEvents:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.scrollbarRef.current.removeEventListener("touchstart",this.onScrollbarTouchStart,!!u&&{passive:!1}),this.thumbRef.current.removeEventListener("touchstart",this.onMouseDown,!!u&&{passive:!1}),this.thumbRef.current.removeEventListener("touchmove",this.onMouseMove,!!u&&{passive:!1}),this.thumbRef.current.removeEventListener("touchend",this.onMouseUp),c.cancel(this.moveRaf)},onMouseDown:function(t){var n=this.$props.onStartMove;e(this.state,{dragging:!0,pageY:C(t),startTop:this.getTop()}),n(),this.patchEvents(),t.stopPropagation(),t.preventDefault()},onMouseMove:function(e){var t=this.state,n=t.dragging,o=t.pageY,i=t.startTop,r=this.$props.onScroll;if(c.cancel(this.moveRaf),n){var l=i+(C(e)-o),a=this.getEnableScrollRange(),s=this.getEnableHeightRange(),u=s?l/s:0,v=Math.ceil(u*a);this.moveRaf=c((function(){r(v)}))}},onMouseUp:function(){var e=this.$props.onStopMove;this.state.dragging=!1,e(),this.removeEvents()},getSpinHeight:function(){var e=this.$props,t=e.height,n=t/e.count*10;return n=Math.max(n,20),n=Math.min(n,t/2),Math.floor(n)},getEnableScrollRange:function(){var e=this.$props;return e.scrollHeight-e.height||0},getEnableHeightRange:function(){return this.$props.height-this.getSpinHeight()||0},getTop:function(){var e=this.$props.scrollTop,t=this.getEnableScrollRange(),n=this.getEnableHeightRange();return 0===e||0===t?0:e/t*n},showScroll:function(){var e=this.$props,t=e.height;return e.scrollHeight>t}},render:function(){var e=this.state,n=e.dragging,r=e.visible,l=this.$props.prefixCls,a=this.getSpinHeight()+"px",s=this.getTop()+"px",u=this.showScroll(),c=u&&r;return t("div",{ref:this.scrollbarRef,class:o("".concat(l,"-scrollbar"),i({},"".concat(l,"-scrollbar-show"),u)),style:{width:"8px",top:0,bottom:0,right:0,position:"absolute",display:c?void 0:"none"},onMousedown:this.onContainerMouseDown,onMousemove:this.delayHidden},[t("div",{ref:this.thumbRef,class:o("".concat(l,"-scrollbar-thumb"),i({},"".concat(l,"-scrollbar-thumb-moving"),n)),style:{width:"100%",height:a,top:s,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:"99px",cursor:"pointer",userSelect:"none"},onMousedown:this.onMouseDown},null)])}});const I="object"===("undefined"==typeof navigator?"undefined":h(navigator))&&/Firefox/i.test(navigator.userAgent),N=function(e,t){var n=!1,o=null;function i(){clearTimeout(o),n=!0,o=setTimeout((function(){n=!1}),50)}return function(r){var l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=r<0&&e.value||r>0&&t.value;return l&&a?(clearTimeout(o),n=!1):a&&!n||i(),!n&&a}};var Y=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},$=[],O={overflowY:"auto",overflowAnchor:"none"};const P=a({name:"List",inheritAttrs:!1,props:{prefixCls:String,data:g.array,height:Number,itemHeight:Number,fullHeight:{type:Boolean,default:void 0},itemKey:{type:[String,Number,Function],required:!0},component:{type:[String,Object]},virtual:{type:Boolean,default:void 0},children:Function,onScroll:Function,onMousedown:Function,onMouseenter:Function,onVisibleChange:Function},setup:function(t,n){var o=n.expose,r=m((function(){var e=t.height,n=t.itemHeight;return!(!1===t.virtual||!e||!n)})),l=m((function(){var e=t.height,n=t.itemHeight,o=t.data;return r.value&&o&&n*o.length>e})),a=s({scrollTop:0,scrollMoving:!1}),g=m((function(){return t.data||$})),T=b([]);f(g,(function(){T.value=M(g.value).slice()}),{immediate:!0});var R=b((function(e){}));f((function(){return t.itemKey}),(function(e){R.value="function"==typeof e?e:function(t){return null==t?void 0:t[e]}}),{immediate:!0});var w=v(),x=v(),L=v(),D=function(e){return R.value(e)},C={getKey:D};function F(e){var t=function(e){var t=e;Number.isNaN(A.value)||(t=Math.min(t,A.value));return t=Math.max(t,0)}("function"==typeof e?e(a.scrollTop):e);w.value&&(w.value.scrollTop=t),a.scrollTop=t}var Y=function(e,t,n,o){var i=new Map,r=new Map,l=v(Symbol("update"));f(e,(function(){l.value=Symbol("update")}));var a=0;function s(){var e=a+=1;Promise.resolve().then((function(){e===a&&i.forEach((function(e,t){if(e&&e.offsetParent){var n=e.offsetHeight;r.get(t)!==n&&(l.value=Symbol("update"),r.set(t,e.offsetHeight))}}))}))}return[function(e,r){var l=t(e),a=i.get(l);r?(i.set(l,r.$el||r),s()):i.delete(l),!a!=!r&&(r?null==n||n(e):null==o||o(e))},s,r,l]}(T,D,null,null),P=y(Y,4),j=P[0],k=P[1],z=P[2],B=P[3],K=s({scrollHeight:void 0,start:0,end:0,offset:void 0}),U=v(0);d((function(){S((function(){var e;U.value=(null===(e=x.value)||void 0===e?void 0:e.offsetHeight)||0}))})),E((function(){S((function(){var e;U.value=(null===(e=x.value)||void 0===e?void 0:e.offsetHeight)||0}))})),f([r,T],(function(){r.value||e(K,{scrollHeight:void 0,start:0,end:T.value.length-1,offset:void 0})}),{immediate:!0}),f([r,T,U,l],(function(){r.value&&!l.value&&e(K,{scrollHeight:U.value,start:0,end:T.value.length-1,offset:void 0})}),{immediate:!0}),f([l,r,function(){return a.scrollTop},T,B,function(){return t.height},U],(function(){if(r.value&&l.value){for(var n,o,i,s=0,u=T.value.length,c=T.value,v=a.scrollTop,f=t.itemHeight,h=v+t.height,d=0;d<u;d+=1){var p=c[d],g=D(p),m=z.get(g);void 0===m&&(m=f);var b=s+m;void 0===n&&b>=v&&(n=d,o=s),void 0===i&&b>h&&(i=d),s=b}void 0===n&&(n=0,o=0),void 0===i&&(i=u-1),i=Math.min(i+1,u),e(K,{scrollHeight:s,start:n,end:i,offset:o})}}),{immediate:!0});var A=m((function(){return K.scrollHeight-t.height}));var V=m((function(){return a.scrollTop<=0})),q=m((function(){return a.scrollTop>=A.value})),_=N(V,q);var J=function(e,t,n,o){var i=0,r=null,l=null,a=!1,s=N(t,n);return[function(t){if(e.value){c.cancel(r);var n=t.deltaY;i+=n,l=n,s(n)||(I||t.preventDefault(),r=c((function(){o(i*(a?10:1)),i=0})))}},function(t){e.value&&(a=t.detail===l)}]}(r,V,q,(function(e){F((function(t){return t+e}))})),Z=y(J,2),G=Z[0],Q=Z[1];function W(e){r.value&&e.preventDefault()}!function(e,t,n){var o=!1,i=0,r=null,l=null,a=function(){r&&(r.removeEventListener("touchmove",s),r.removeEventListener("touchend",u))},s=function(e){if(o){var t=Math.ceil(e.touches[0].pageY),r=i-t;i=t,n(r)&&e.preventDefault(),clearInterval(l),l=setInterval((function(){(!n(r*=.9333333333333333,!0)||Math.abs(r)<=.1)&&clearInterval(l)}),16)}},u=function(){o=!1,a()},c=function(e){a(),1!==e.touches.length||o||(o=!0,i=Math.ceil(e.touches[0].pageY),(r=e.target).addEventListener("touchmove",s,{passive:!1}),r.addEventListener("touchend",u))},v=function(){};d((function(){document.addEventListener("touchmove",v,{passive:!1}),f(e,(function(e){t.value.removeEventListener("touchstart",c),a(),clearInterval(l),e&&t.value.addEventListener("touchstart",c,{passive:!1})}),{immediate:!0})})),p((function(){document.removeEventListener("touchmove",v)}))}(r,w,(function(e,t){return!_(e,t)&&(G({preventDefault:function(){},deltaY:e}),!0)}));var X=function(){w.value&&(w.value.removeEventListener("wheel",G,!!u&&{passive:!1}),w.value.removeEventListener("DOMMouseScroll",Q),w.value.removeEventListener("MozMousePixelScroll",W))};H((function(){S((function(){w.value&&(X(),w.value.addEventListener("wheel",G,!!u&&{passive:!1}),w.value.addEventListener("DOMMouseScroll",Q),w.value.addEventListener("MozMousePixelScroll",W))}))})),p((function(){X()}));var ee=function(e,t,n,o,i,r,l,a){var s;return function(u){if(null!=u){c.cancel(s);var v=t.value,f=o.itemHeight;if("number"==typeof u)l(u);else if(u&&"object"===h(u)){var d,p=u.align;d="index"in u?u.index:v.findIndex((function(e){return i(e)===u.key}));var g=u.offset,m=void 0===g?0:g;!function t(o,a){if(!(o<0)&&e.value){var u=e.value.clientHeight,h=!1,g=a;if(u){for(var b=a||p,M=0,y=0,S=0,E=Math.min(v.length,d),H=0;H<=E;H+=1){var T=i(v[H]);y=M;var R=n.get(T);M=S=y+(void 0===R?f:R),H===d&&void 0===R&&(h=!0)}var w=e.value.scrollTop,x=null;switch(b){case"top":x=y-m;break;case"bottom":x=S-u+m;break;default:y<w?g="top":S>w+u&&(g="bottom")}null!==x&&x!==w&&l(x)}s=c((function(){h&&r(),t(o-1,g)}))}}(3)}}else a()}}(w,T,z,t,D,k,F,(function(){var e;null===(e=L.value)||void 0===e||e.delayHidden()}));o({scrollTo:ee});var te=m((function(){var n=null;return t.height&&(n=e(i({},t.fullHeight?"height":"maxHeight",t.height+"px"),O),r.value&&(n.overflowY="hidden",a.scrollMoving&&(n.pointerEvents="none"))),n}));return f([function(){return K.start},function(){return K.end},T],(function(){if(t.onVisibleChange){var e=T.value.slice(K.start,K.end+1);t.onVisibleChange(e,T.value)}}),{flush:"post"}),{state:a,mergedData:T,componentStyle:te,onFallbackScroll:function(e){var n,o=e.currentTarget.scrollTop;Math.abs(o-a.scrollTop)>=1&&F(o),null===(n=t.onScroll)||void 0===n||n.call(t,e)},onScrollBar:function(e){F(e)},componentRef:w,useVirtual:r,calRes:K,collectHeight:k,setInstance:j,sharedConfig:C,scrollBarRef:L,fillerInnerRef:x}},render:function(){var n=this,i=e(e({},this.$props),this.$attrs),r=i.prefixCls,l=void 0===r?"rc-virtual-list":r,a=i.height;i.itemHeight,i.fullHeight,i.data,i.itemKey,i.virtual;var s=i.component,u=void 0===s?"div":s;i.onScroll;var c=i.children,v=void 0===c?this.$slots.default:c,f=i.style,h=i.class,d=Y(i,["prefixCls","height","itemHeight","fullHeight","data","itemKey","virtual","component","onScroll","children","style","class"]),p=o(l,h),g=this.state.scrollTop,m=this.calRes,b=m.scrollHeight,M=m.offset,y=m.start,S=m.end,E=this.componentStyle,H=this.onFallbackScroll,R=this.onScrollBar,w=this.useVirtual,L=this.collectHeight,C=this.sharedConfig,I=this.setInstance,N=this.mergedData;return t("div",T({style:e(e({},f),{position:"relative"}),class:p},d),[t(u,{class:"".concat(l,"-holder"),style:E,ref:"componentRef",onScroll:H},{default:function(){return[t(x,{prefixCls:l,height:b,offset:M,onInnerResize:L,ref:"fillerInnerRef"},{default:function(){return e=N,n=y,o=S,i=I,r=v,l=C.getKey,e.slice(n,o+1).map((function(e,o){var a=r(e,n+o,{}),s=l(e);return t(D,{key:s,setRef:function(t){return i(e,t)}},{default:function(){return[a]}})}));var e,n,o,i,r,l}})]}}),w&&t(F,{ref:"scrollBarRef",prefixCls:l,scrollTop:g,height:a,scrollHeight:b,count:N.length,onScroll:R,onStartMove:function(){n.state.scrollMoving=!0},onStopMove:function(){n.state.scrollMoving=!1}},null)])}});export{P as L,R as c};

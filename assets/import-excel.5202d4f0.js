import{P as e}from"./PageWrapper.3c353e2a.js";import{d as t,b as r,c as a,K as s,i as o,B as i,a as l,aI as n,j as d,bS as c}from"./index.86be3cdc.js";import{u as p}from"./useExcel.b85bee65.js";import{C as m}from"./Card.1b044283.js";import{A as u}from"./index.8adf1d87.js";import{U as x}from"./index.709cf579.js";import{C as f}from"./CloudUploadOutlined.4ce58132.js";import{A as j}from"./index.d213577d.js";import"./Col.7bb40ef1.js";import"./useFlexGapSupport.43d0875f.js";import"./EyeOutlined.22f66ec3.js";import"./DeleteOutlined.a97c32e1.js";import"./CheckOutlined.47584c4b.js";import"./index.a24c6d58.js";import"./Form.4bf0d113.js";import"./toArray.4c9e7d5a.js";import"./FormItemContext.de621b15.js";import"./iconUtil.5c0d2117.js";import"./List.3852e666.js";import"./index.a24dd3fd.js";import"./antInputDirective.8e6978aa.js";import"./SearchOutlined.e66b1444.js";import"./index.9073a514.js";import"./Checkbox.28213be5.js";import"./Checkbox.83da78e0.js";import"./index.6b3bdb76.js";import"./Group.2c21b420.js";import"./index.4e046040.js";import"./Input.c6c39719.js";import"./index.3ac2c4ab.js";const b=t({name:"ImportExcel",setup(){const t=r([]),b=r([]),{readDataFromExcel:C}=p();function g(){n(c)}function h(e){const{file:r}=e,a=r.originFileObj;if(!a)return;if(!/\.(xlsx|xls|csv)$/.test(a.name))return void d.warning("Excel文件只支持.xlsx, .xls, .csv格式!");a.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:a,results:s}=C(r,"array");b.value=a.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=s},r.readAsArrayBuffer(e),r.onerror=()=>{d.error("Excel文件读取出错!")}}(a):d.warning("上传的Excel文件大小不能超过1M!")}return()=>a(e,{name:"JS-xlsx插件"},{header:()=>a(s,null,[a("p",null,[o("JS-xlsx: 由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库, 功能强大, 支持xlsx、csv、txt等格式。")]),a("p",null,[o("组件地址:"),a(i,{type:"link",onClick:g},{default:()=>[o("立即访问")]})])]),default:()=>a(m,{bordered:!1},{default:()=>[a(u,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[a(x,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:h},{default:()=>[a("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[a(f,null,null)]),a("p",null,[o("将Excel文件拖到此处, 或"),a("span",{style:"color: #1890ff;"},[o("点击上传")])])]}),a(j,{dataSource:l(t),columns:l(b),pagination:!1},null)]})]})})}});export{b as default};

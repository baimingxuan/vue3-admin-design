import{P as e}from"./PageWrapper.a7647f34.js";import{d as t,b as r,c as a,K as s,i as o,B as i,a as l,aI as n,j as c,bS as d}from"./index.70334207.js";import{u as p}from"./useExcel.710c468f.js";import{C as m}from"./Card.ee5d8653.js";import{A as u}from"./index.d04c01f2.js";import{U as x}from"./index.e8ec2f1a.js";import{C as f}from"./CloudUploadOutlined.f861ede4.js";import{A as j}from"./index.452683f3.js";import"./Col.bfbeb36b.js";import"./useFlexGapSupport.229a03b0.js";import"./EyeOutlined.b925c9c3.js";import"./DeleteOutlined.4a2ca319.js";import"./CheckOutlined.85bc879d.js";import"./index.893a1d45.js";import"./Form.f3023c1e.js";import"./toArray.834367be.js";import"./FormItemContext.90f1956e.js";import"./iconUtil.28adbeeb.js";import"./List.906e773d.js";import"./index.0a9297be.js";import"./antInputDirective.8e6978aa.js";import"./SearchOutlined.445baf93.js";import"./index.c288fc95.js";import"./Checkbox.bbedcbc0.js";import"./Checkbox.45a313ab.js";import"./index.30685292.js";import"./Group.a1edb011.js";import"./index.cdd22bf6.js";import"./Input.7c132771.js";import"./index.a67a0ec6.js";const b=t({name:"ImportExcel",setup(){const t=r([]),b=r([]),{readDataFromExcel:C}=p();function g(){n(d)}function h(e){const{file:r}=e,a=r.originFileObj;if(!a)return;if(!/\.(xlsx|xls|csv)$/.test(a.name))return void c.warning("Excel文件只支持.xlsx, .xls, .csv格式!");a.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:a,results:s}=C(r,"array");b.value=a.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=s},r.readAsArrayBuffer(e),r.onerror=()=>{c.error("Excel文件读取出错!")}}(a):c.warning("上传的Excel文件大小不能超过1M!")}return()=>a(e,{name:"JS-xlsx插件"},{header:()=>a(s,null,[a("p",null,[o("JS-xlsx: 由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库, 功能强大, 支持xlsx、csv、txt等格式。")]),a("p",null,[o("组件地址:"),a(i,{type:"link",onClick:g},{default:()=>[o("立即访问")]})])]),default:()=>a(m,{bordered:!1},{default:()=>[a(u,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[a(x,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:h},{default:()=>[a("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[a(f,null,null)]),a("p",null,[o("将Excel文件拖到此处, 或"),a("span",{style:"color: #1890ff;"},[o("点击上传")])])]}),a(j,{dataSource:l(t),columns:l(b),pagination:!1},null)]})]})})}});export{b as default};
